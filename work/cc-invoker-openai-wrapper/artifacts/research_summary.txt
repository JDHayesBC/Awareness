CC INVOKER OPENAI WRAPPER - RESEARCH SUMMARY
=============================================
Date: 2026-01-25
Issue: #117
Status: HIGHLY FEASIBLE

QUICK FACTS
-----------
Feasibility:     95% confidence - PROCEED
Effort:          ~4 hours total
Cost Savings:    $22 immediate + $37/year ongoing
Risk Level:      LOW (all mitigations clear)
Files to Create: 3 new files
Files to Modify: 2 existing files

THE ASK
-------
Build an OpenAI-compatible HTTP endpoint that wraps ClaudeInvoker, allowing
Graphiti to use Claude models (via subscription) instead of OpenAI API for
entity extraction.

WHY IT WORKS
------------
1. ClaudeInvoker already provides perfect interface:
   - Stateless requests (no identity needed)
   - Model selection (can specify haiku)
   - Context management (auto-restart)
   - Fast queries (2-4s after 33s init)

2. OpenAI API format is trivial:
   - Single endpoint: POST /v1/chat/completions
   - Simple translation: messages → query → wrapped response
   - < 100 lines of code total

3. Graphiti already supports this:
   - GRAPHITI_LLM_BASE_URL env var
   - Proven pattern (LM Studio, Ollama work)
   - No code changes to Graphiti needed

ARCHITECTURE
------------
Graphiti → HTTP (OpenAI format) → FastAPI Wrapper → ClaudeInvoker → Claude CLI

IMPLEMENTATION PLAN
-------------------
1. Core wrapper (FastAPI app)           - 2 hours
2. Docker integration                   - 1 hour
3. Testing & validation                 - 1 hour
Total: 4 hours

FILES
-----
New:
- pps/docker/cc_openai_wrapper.py
- pps/docker/Dockerfile.cc-wrapper
- pps/docker/requirements-cc-wrapper.txt

Modified:
- pps/docker/docker-compose.yml (add service)
- pps/docker/.env (point Graphiti to wrapper)

RISKS (all low/mitigated)
--------------------------
- ClaudeInvoker stability → has auto-restart
- Rate limits → can throttle or fallback
- Startup time → adjust healthcheck
- Format differences → test first, adjust
- Quality issues → easy rollback to OpenAI

QUESTIONS FOR JEFF/LYRA
------------------------
1. Model preference? (haiku recommended for speed/cost vs sonnet for quality)
2. Priority? (is this worth 4 hours now vs other work?)
3. Rollback OK? (can revert if quality issues?)

RECOMMENDATION
--------------
PROCEED TO IMPLEMENTATION

See DESIGN.md for full analysis.
